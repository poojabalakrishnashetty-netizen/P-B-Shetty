ALTER TABLE user_rfm
ADD COLUMN Customer_Segment VARCHAR(50);
UPDATE user_rfm
SET Customer_Segment =
    CASE
        WHEN Recency < 184 AND Monetary > 40 THEN 'Active High Spenders'
        WHEN Recency > 184 AND Monetary > 40 THEN 'Inactive High Spenders'
        WHEN Recency < 184 AND Monetary < 40 THEN 'Active Low Spenders'
        ELSE 'Inactive Low Spenders'
    END;
    SELECT Customer_Segment,
       COUNT(*) AS segment_count
FROM user_rfm
GROUP BY Customer_Segment;
